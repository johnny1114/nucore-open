%ul.form
  - if controller.action_name == 'new' || controller.action_name == 'create'
    = hidden_field_tag "owner_user_id", @owner_user.id, :class => 'NufsAccount CreditCardAccount PurchaseOrderAccount'
    %li
      = label_tag :owner_user_id, t('facility_accounts.account_fields.label.owner_user'), :class => 'require'
      = text_field_tag 'owner_user_full_name', @owner_user.full_name, :disabled => true, :class => 'show_always'
    %li
      = label_tag :class_type, t('facility_accounts.account_fields.label.payment_type'), :class => 'require'
      = select_tag 'class_type', options_for_select([[t('accounts.institution'), "NufsAccount"], [t('accounts.credit_card'), "CreditCardAccount"], [t('accounts.po'), "PurchaseOrderAccount"]], :selected => params[:class_type]), :class => 'NufsAccount CreditCardAccount PurchaseOrderAccount'
    %li
      = f.label :account_number, t('facility_accounts.account_fields.label.payment_number'), :class => 'require'
      = f.text_field :account_number, :class => 'NufsAccount PurchaseOrderAccount'
    %li
      = f.label :name_on_card, t('facility_accounts.account_fields.label.cc_name'), :class => 'require'
      = f.text_field :name_on_card, :class => 'CreditCardAccount'
    %li
      = f.label :expiration_month, nil, :class => 'require'
      = f.select :expiration_month, (1..12).to_a, {}, :class => 'CreditCardAccount'
    %li
      = f.label :expiration_year, nil, :class => 'require'
      = f.select :expiration_year, (Time.zone.now.year..(Time.zone.now.year + 10)).to_a, {}, :class => 'CreditCardAccount'
    %li
      = f.label :expires_at, nil, :class => 'require'
      = f.text_field :expires_at, :value => (begin @account.expires_at.strftime("%m/%d/%Y") rescue nil end), :id => 'datepicker', :class => 'PurchaseOrderAccount'

  %li
    = f.label :description, nil, :class => 'require'
    %p.instruction.CreditCardAccount
      - if instructions_for == :all
        = t('facility_accounts.account_fields.label.all_instruct')
      - elsif instructions_for == 'CreditCardAccount'
        = t('facility_accounts.account_fields.label.cc_instruct')
    = f.text_field :description, :class => 'NufsAccount CreditCardAccount PurchaseOrderAccount'

  - if @account.class == Account || @account.is_a?(AffiliateAccount)
    - opts = {:include_blank => true}
    - opts.merge!(:selected => @account.affiliate.try(:name)) if @account
    %li
      = f.label :affiliate, nil, :class => 'require'
      = f.select :affiliate, Affiliate.all.collect(&:name).sort, opts, :id => 'affiliate', :class => 'CreditCardAccount PurchaseOrderAccount'

    %li#affiliate_other
      = f.label :affiliate_other, t('facility_accounts.account_fields.label.affiliate'), :class => 'require'
      = f.text_field :affiliate_other, :class => 'CreditCardAccount PurchaseOrderAccount'

  - unless @account.is_a?(NufsAccount)
    %li
      = f.label :remittance_information, t('facility_accounts.account_fields.label.remit')
      %p.instruction.CreditCardAccount.PurchaseOrderAccount= t('facility_accounts.account_fields.label.po_instruct')
      = f.text_area :remittance_information, :cols => 92, :rows => 6, :class => 'CreditCardAccount PurchaseOrderAccount'
